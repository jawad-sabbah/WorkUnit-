<%- include('../partials/header') %>

<div class="max-w-4xl mx-auto px-4 py-10 space-y-12 font-sans text-gray-900">

  <a href="/layout" class="inline-flex items-center text-blue-600 hover:text-blue-800 mb-6">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
    </svg>
    Back Home
  </a>

  <!-- Project Details -->
  <section class="bg-white border border-gray-200 rounded-lg shadow-sm p-6">
    <div class="flex items-center justify-between mb-4">
      <h1 class="text-3xl font-semibold tracking-tight"><%= project.name %></h1>
      <% if (project.status) { %>
        <span class="text-xs font-medium px-3 py-1 rounded-full uppercase tracking-wide
          <% if (project.status === 'Completed') { %> bg-green-100 text-green-800
          <% } else if (project.status === 'In Progress') { %> bg-yellow-100 text-yellow-800
          <% } else { %> bg-gray-100 text-gray-700 <% } %>">
          <%= project.status %>
        </span>
      <% } %>
    </div>
    <p class="text-gray-600 text-base mb-4"><%= project.description %></p>
    <div class="text-sm text-gray-500 flex flex-wrap gap-6">
      <span>Owner: <%= project.owner_username %></span>
      <span>Created: <%= new Date(project.created_at).toLocaleDateString() %></span>
    </div>
  </section>

 <!-- Task Section -->
<section class="space-y-6">
  <div class="flex items-center justify-between">
    <h2 class="text-xl font-semibold">Tasks</h2>
    <a href="/projects/<%= project.id %>/tasks/new" class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition">
      + Add Task
    </a>
  </div>

  <% if (tasks.length === 0) { %>
    <div class="border border-gray-200 bg-gray-50 text-gray-600 text-center py-6 rounded-md">
      No tasks yet. Start by adding a new one.
    </div>
  <% } else { %>
    <div class="space-y-4">
      <% tasks.forEach(task => { %>
        <div class="bg-white border border-gray-200 rounded-md shadow-sm p-4 flex items-start justify-between">
          <div class="flex items-start space-x-3 w-full">
            <!-- Checkbox -->
            <form method="POST" action="/projects/<%= project.id %>/tasks/<%= task.id %>/toggle" class="mt-1">
              <input 
                type="checkbox" 
                name="completed" 
                onchange="this.form.submit()" 
                <% if (task.status === 'Completed') { %> checked <% } %>
                class="h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"
              />
            </form>

            <!-- Task Content -->
            <div class="flex-1">
              <h3 class="text-base font-medium text-gray-800 <%= task.status === 'Completed' ? 'line-through text-gray-400' : '' %>">
                <%= task.title %>
              </h3>
              <p class="text-sm text-gray-600 mt-1"><%= task.description %></p>

              <!-- Status + Edit Button -->
              <div class="flex items-center space-x-4 mt-2">
                <span class="text-xs font-medium px-2 py-1 rounded-full
                  <% if (task.status === 'Completed') { %> bg-green-100 text-green-800
                  <% } else if (task.status === 'In Progress') { %> bg-yellow-100 text-yellow-800
                  <% } else { %> bg-gray-100 text-gray-700 <% } %>">
                  <%= task.status %>
                </span>

                <a href="/projects/<%= project.id %>/tasks/<%= task.id %>/edit" 
                   class="text-sm text-blue-600 hover:underline">
                  Edit
                </a>
              </div>
            </div>
          </div>
        </div>
      <% }) %>
    </div>
  <% } %>
</section>


</div>
